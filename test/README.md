# 테스트 스크립트

## unittest.sh

`$ ./unittest.sh`

`module` 디렉토리의 `queue.c` `list.c` `hashmap.c` 에 대한 테스트를 실행한다.

## run_test_server.sh

`$ ./run_test_server.sh`

* `server.out` 프로그램을 백그라운드에서 실행시키고 표준출력을 `server_test.log`로 리다이렉션한다.
* 상위 디렉토리의 `server.out`이 빌드되어 있어야 한다.

## client.test

`$ ./client.test [서버 ip] [서버 port] [파일 이름] [0|1]`

* `make` 명령어로 생성
* 아래의 테스트를 진행하기 위해 필요한 클라이언트 프로그램

## upload.sh

`$ ./upload_test.sh [업로드할 파일] [횟수] [0|1]`

* 전달받은 파일을 이름을 바꿔가며 업로드한다. 
* 각 업로드마다 클라이언트가 서버에 접속하고 종료된다.
* 서버의 주소는 하드코딩되어있다

## parallel_upload.sh

`$ ./upload_test.sh [업로드할 파일] [n] [m]`

* n개의 프로세스에서 파일을 m번 전송한다. 
    * fork: Resource temporarily unavailable. 이라는 에러 메세지가 출력될 수 있다.
    * `$ ulimit -u` 명령어로 해결
* 각 요청마다 클라이언트가 서버에 접속하고 종료한다.
* ` 내부적으로 'upload_test.sh' 스크립트를 사용한다.

## 결과

* 클라이언트가 성공적으로 전송하면 서버는 모두 처리할 수 있었다.
* 2.9MB 업로드 요청에 평균적으로 165.112ms 소요
* 초당 17754051.7951B의 업로드 요청 수행

<pre>
# max_sessions worker_num elapsed_time transmissions successed file_size
500 400 13:42:23:133 13:42:54:798 31665 500 206 11099
500 200 13:56:37:986 13:56:39:488 1502 500 500 11099
500 200 13:58:24:476 13:58:50:665 26189 200 200 2931407
500 200 14:10:40:233 14:11:06:272 26039 200 200 2931407
500 500 14:21:58:228 14:23:00:169 -51718228 381 381 29331407
500 500 15:05:00:816 15:05:00:699 0 500 500 11099
500 500 15:10:32:177 15:11:47:300 75123 470 470 2931407
500 500 15:23:49:478 15:25:12:808 83330 334 334 2931407
500 500 15:53:03:798 15:54:52:328 108530 343 343 2931407
500 500 16:24:33:316 16:24:34:337 1021 500 500 11099
500 500 16:46:58:266 16:47:35:560 37294 222 222 2931407
500 500 20:02:56:182  -72176182 293 293 3946825
500 500 20:24:23:775 20:25:22:760 58985 112 112 1256242
500 500 20:32:20:469 20: -73940469 96 96 1256242
500 500 20:36:30:510 20:36:32:773 2263 500 500 11099
500 500 20:38:26:530 20:38:34:791 8261 500 500 42159
500 500 20:44:04:878 20:44:24:123 19245 489 489 51706
1000 1000 20:55:12:631 20:55:18:472 5841 997 997 11099
1000 1000 21:08:41:396 21:08:44:789 3393 1000 1000 11099
// connection timed out
1000 1000 21:11:17:345 21:13:44:784 147439 988 988 2931407			
// connection retry
1000 1000 21:26:48:680 21:29:44:710 176030 1000 1000 2931407		
1000 1000 21:36:21:826 21:39:06:938 165112 1000 1000 2931407
</pre>
